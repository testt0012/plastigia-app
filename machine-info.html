<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <title>Πληροφορίες Μηχανής - Plastigia</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
            background-color: #FFFFFF; /* Λευκό φόντο */
            color: #000000; /* Μαύρο κείμενο */
        }
        .header {
            position: relative;
            background-color: #FF0000; /* Κόκκινο φόντο header */
            padding: 10px;
            color: #FFFFFF; /* Λευκό κείμενο στο header */
        }
        .logo {
            max-width: 200px; /* Ρύθμιση μεγέθους λογοτύπου */
            margin: 10px auto;
        }
        .logout-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 5px 10px;
            background-color: #FF0000;
            color: #FFFFFF;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }
        .logout-btn:hover {
            background-color: #CC0000;
        }
        .back-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 5px 10px;
            background-color: #FF0000;
            color: #FFFFFF;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }
        .back-btn:hover {
            background-color: #CC0000;
        }
        .container {
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            border: 1px solid #FF0000; /* Κόκκινο περίγραμμα */
            border-radius: 5px;
        }
        .section {
            margin-bottom: 20px;
            text-align: ${role === 'user' ? 'left' : 'right'}; /* Αριστερά για user, δεξιά για admin */
        }
        h2 {
            color: #FF0000; /* Κόκκινο για κεφαλίδες */
            text-align: center;
        }
        .admin-info span {
            font-weight: bold;
            color: #FF0000; /* Κόκκινο για τα προσυμπληρωμένα */
        }
        .input-row {
            display: flex;
            align-items: center;
            justify-content: ${role === 'user' ? 'flex-start' : 'flex-end'}; /* Αριστερά για user, δεξιά για admin */
            margin: 5px 0;
        }
        label {
            display: inline-block;
            width: 70%; /* Πλάτος ετικέτας */
            margin-left: ${role === 'user' ? '0' : '10px'}; /* Χωρίσματα για align */
            margin-right: ${role === 'user' ? '10px' : '0'};
            text-align: left; /* Labels στοιχίζονται αριστερά μέσα στο flex */
            font-weight: bold;
        }
        input, select {
            width: 20%; /* Μικρότερο πλάτος για όλα τα πεδία */
            padding: 5px;
            font-size: 14px;
            border: 1px solid #FF0000;
            border-radius: 3px;
            display: inline-block;
            vertical-align: middle;
        }
        input[type="number"] {
            width: 20%; /* Μικρότερο πλάτος για αριθμητικά, ίδιο με τα άλλα */
        }
        input[readonly] {
            background-color: #f0f0f0;
            cursor: not-allowed;
        }
        button {
            padding: 10px 20px;
            background-color: #FF0000; /* Κόκκινο κουμπί */
            color: #FFFFFF; /* Λευκό κείμενο */
            border: none;
            cursor: pointer;
            border-radius: 5px;
            margin-top: 10px;
        }
        button:hover {
            background-color: #CC0000; /* Σκουρότερο κόκκινο στο hover */
        }
        .hidden {
            display: none;
        }
        .prep-material-btn {
            padding: 5px 10px;
            background-color: #FF0000;
            color: #FFFFFF;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            margin-top: 10px;
        }
        .prep-material-btn:hover {
            background-color: #CC0000;
        }
    </style>
</head>
<body>
    <div class="header">
        <button class="back-btn" onclick="goBack()">Πίσω</button>
        <img src="plastigia-logo.png" alt="Plastigia Logo" class="logo">
        <button class="logout-btn" onclick="logout()">Αποσύνδεση</button>
    </div>
    <div class="container" id="container">
        <h2>Πληροφορίες Μηχανής</h2>
        <div class="section">
            <div class="input-row"><label>Πελάτης:</label><input type="text" id="client" placeholder="Όνομα πελάτη" ${role === 'user' ? 'readonly' : ''}></div>
            <div class="input-row"><label>Καλούπι:</label><input type="text" id="mold" placeholder="Κωδικός ή όνομα καλουπιού" ${role === 'user' ? 'readonly' : ''}></div>
            <div class="input-row"><label>Ημερομηνία Παράδοσης:</label><input type="date" id="deliveryDate" ${role === 'user' ? 'readonly' : ''}></div>
        </div>
        <h2>Στοιχεία Καλουπιού</h2>
        <div class="section">
            <div class="input-row"><label>Δευτ/Πάτημα:</label><input type="number" id="cyclesPerShot" placeholder="Δευτ." ${role === 'user' ? 'readonly' : ''}></div>
            <div class="input-row"><label>gr/Πάτημα:</label><input type="number" id="gramsPerShot" placeholder="gr" ${role === 'user' ? 'readonly' : ''}></div>
            <div class="input-row"><label>gr/αντικειμένου:</label><input type="number" id="gramsPerItem" placeholder="gr" ${role === 'user' ? 'readonly' : ''}></div>
            <div class="input-row"><label>τμχ/πάτημα:</label><input type="number" id="itemsPerShot" placeholder="τμχ" ${role === 'user' ? 'readonly' : ''}></div>
            <div class="input-row"><label>Βουλωμένες Κοιλότητες:</label><input type="number" id="blockedCavities" placeholder="Αριθμός" ${role === 'user' ? 'readonly' : ''}></div>
            <div class="input-row"><label>Υλικό:</label><input type="text" id="material" placeholder="Τύπος υλικού" ${role === 'user' ? 'readonly' : ''}></div>
            <div class="input-row"><label>Μηχανή:</label><p><span class="admin-info">${machineName || 'Άγνωστη Μηχανή'}</span></p></div>
        </div>
        <h2>Στοιχεία Παραγγελίας</h2>
        <div class="section">
            <div class="input-row"><label>Τεμάχια:</label><input type="number" id="items" placeholder="Πληκτρολόγησε τεμάχια" ${role === 'user' ? 'readonly' : ''}></div>
            <div class="input-row"><label>Σύνολο Υλικού:</label><input type="number" id="totalMaterial" placeholder="Πληκτρολόγησε γραμμάρια" ${role === 'user' ? 'readonly' : ''}></div>
            <div class="input-row"><label>Χρώμα:</label><input type="text" id="color" placeholder="Πληκτρολόγησε χρώμα" ${role === 'user' ? 'readonly' : ''}></div>
            <div class="input-row"><label>Ώρες:</label><input type="number" id="hours" placeholder="Πληκτρολόγησε ώρες" ${role === 'user' ? 'readonly' : ''}></div>
        </div>
        <h2>Στοιχεία Παράδοσης</h2>
        <div class="section">
            <div class="input-row"><label>Ώρα Έναρξης:</label><input type="text" id="startTime" placeholder="π.χ. 14:30" ${role === 'user' ? 'readonly' : ''}></div>
            <div class="input-row"><label>Ενδεικτική Ώρα Λήξης:</label><input type="text" id="estimatedEndTime" placeholder="π.χ. 18:00" ${role === 'user' ? 'readonly' : ''}></div>
        </div>
        <h2>Στοιχεία Συσκευασίας</h2>
        <div class="section">
            <div class="input-row"><label>τμχ/σακουλάκι:</label><input type="number" id="itemsPerBag" placeholder="Πληκτρολόγησε τεμάχια" ${role === 'user' ? 'readonly' : ''}></div>
            <div class="input-row"><label>Σακουλάκι:</label><input type="number" id="bags" placeholder="Πληκτρολόγησε αριθμό σακουλιών" ${role === 'user' ? 'readonly' : ''}></div>
        </div>
        <div ${role === 'user' ? '' : 'style="display: none;"'}>
            <button class="prep-material-btn" onclick="openMaterialPrep()">Φόρμα Προετοιμασίας Υλικού</button>
        </div>
        <div>
            <button onclick="saveData()" id="saveButton" ${role === 'user' ? 'style="display: none;"' : ''}>Αποθήκευση</button>
            <button onclick="newOrder()" id="newOrderButton" ${role === 'user' ? 'style="display: none;"' : ''} style="margin-left: 10px;">Νέα Παραγγελία</button>
        </div>
    </div>
    <script>
        // Έλεγχος ρόλου
        const role = sessionStorage.getItem('role');
        if (!role) {
            alert('Πρέπει να συνδεθείτε!');
            window.location.href = "index.html";
        }

        // Λήψη παραμέτρου από το URL (όνομα μηχανής)
        const urlParams = new URLSearchParams(window.location.search);
        const machineName = urlParams.get('name');

        // Φόρτωση δεδομένων από το localStorage
        const data = JSON.parse(localStorage.getItem('machineData_' + machineName)) || {};
        if (role === 'user') {
            // Για user, εμφάνιση δεδομένων ως κείμενο
            document.getElementById('container').innerHTML = `
                <h2>Πληροφορίες Μηχανής</h2>
                <div class="section">
                    <div class="input-row"><label>Πελάτης:</label><p><span class="admin-info">${data.client || 'Δεν ορίστηκε'}</span></p></div>
                    <div class="input-row"><label>Καλούπι:</label><p><span class="admin-info">${data.mold || 'Δεν ορίστηκε'}</span></p></div>
                    <div class="input-row"><label>Ημερομηνία Παράδοσης:</label><p><span class="admin-info">${data.deliveryDate || 'Δεν ορίστηκε'}</span></p></div>
                </div>
                <h2>Στοιχεία Καλουπιού</h2>
                <div class="section">
                    <div class="input-row"><label>Δευτ/Πάτημα:</label><p><span class="admin-info">${data.cyclesPerShot || 'Δεν ορίστηκε'}</span></p></div>
                    <div class="input-row"><label>gr/Πάτημα:</label><p><span class="admin-info">${data.gramsPerShot || 'Δεν ορίστηκε'}</span></p></div>
                    <div class="input-row"><label>gr/αντικειμένου:</label><p><span class="admin-info">${data.gramsPerItem || 'Δεν ορίστηκε'}</span></p></div>
                    <div class="input-row"><label>τμχ/πάτημα:</label><p><span class="admin-info">${data.itemsPerShot || 'Δεν ορίστηκε'}</span></p></div>
                    <div class="input-row"><label>Βουλωμένες Κοιλότητες:</label><p><span class="admin-info">${data.blockedCavities || 'Δεν ορίστηκε'}</span></p></div>
                    <div class="input-row"><label>Υλικό:</label><p><span class="admin-info">${data.material || 'Δεν ορίστηκε'}</span></p></div>
                    <div class="input-row"><label>Μηχανή:</label><p><span class="admin-info">${machineName || 'Άγνωστη Μηχανή'}</span></p></div>
                </div>
                <h2>Στοιχεία Παραγγελίας</h2>
                <div class="section">
                    <div class="input-row"><label>Τεμάχια:</label><p><span class="admin-info">${data.items || 'Δεν ορίστηκε'}</span></p></div>
                    <div class="input-row"><label>Σύνολο Υλικού:</label><p><span class="admin-info">${data.totalMaterial || 'Δεν ορίστηκε'}</span></p></div>
                    <div class="input-row"><label>Χρώμα:</label><p><span class="admin-info">${data.color || 'Δεν ορίστηκε'}</span></p></div>
                    <div class="input-row"><label>Ώρες:</label><p><span class="admin-info">${data.hours || 'Δεν ορίστηκε'}</span></p></div>
                </div>
                <h2>Στοιχεία Παράδοσης</h2>
                <div class="section">
                    <div class="input-row"><label>Ώρα Έναρξης:</label><p><span class="admin-info">${data.startTime || 'Δεν ορίστηκε'}</span></p></div>
                    <div class="input-row"><label>Ενδεικτική Ώρα Λήξης:</label><p><span class="admin-info">${data.estimatedEndTime || 'Δεν ορίστηκε'}</span></p></div>
                </div>
                <h2>Στοιχεία Συσκευασίας</h2>
                <div class="section">
                    <div class="input-row"><label>τμχ/σακουλάκι:</label><p><span class="admin-info">${data.itemsPerBag || 'Δεν ορίστηκε'}</span></p></div>
                    <div class="input-row"><label>Σακουλάκι:</label><p><span class="admin-info">${data.bags || 'Δεν ορίστηκε'}</span></p></div>
                </div>
                <div ${role === 'user' ? '' : 'style="display: none;"'}>
                    <button class="prep-material-btn" onclick="openMaterialPrep()">Φόρμα Προετοιμασίας Υλικού</button>
                </div>
            `;
        } else {
            // Για admin, φόρτωση ως πεδία
            document.getElementById('client').value = data.client || '';
            document.getElementById('mold').value = data.mold || '';
            document.getElementById('deliveryDate').value = data.deliveryDate || '';
            document.getElementById('cyclesPerShot').value = data.cyclesPerShot || '';
            document.getElementById('gramsPerShot').value = data.gramsPerShot || '';
            document.getElementById('gramsPerItem').value = data.gramsPerItem || '';
            document.getElementById('itemsPerShot').value = data.itemsPerShot || '';
            document.getElementById('blockedCavities').value = data.blockedCavities || '';
            document.getElementById('material').value = data.material || '';
            document.getElementById('items').value = data.items || '';
            document.getElementById('totalMaterial').value = data.totalMaterial || '';
            document.getElementById('color').value = data.color || '';
            document.getElementById('hours').value = data.hours || '';
            document.getElementById('startTime').value = data.startTime || '';
            document.getElementById('estimatedEndTime').value = data.estimatedEndTime || '';
            document.getElementById('itemsPerBag').value = data.itemsPerBag || '';
            document.getElementById('bags').value = data.bags || '';
        }

        // Εάν δεν υπάρχουν δεδομένα και ο χρήστης είναι user, εμφάνιση μηνύματος
        if (role === 'user' && Object.keys(data).length === 0) {
            document.getElementById('container').innerHTML = '<h2>Η μηχανή δεν χρησιμοποιείται</h2>';
        }

        // Αποθήκευση δεδομένων και Νέα Παραγγελία
        function saveData() {
            if (role === 'admin') {
                const data = {
                    client: document.getElementById('client').value,
                    mold: document.getElementById('mold').value,
                    deliveryDate: document.getElementById('deliveryDate').value,
                    cyclesPerShot: document.getElementById('cyclesPerShot').value,
                    gramsPerShot: document.getElementById('gramsPerShot').value,
                    gramsPerItem: document.getElementById('gramsPerItem').value,
                    itemsPerShot: document.getElementById('itemsPerShot').value,
                    blockedCavities: document.getElementById('blockedCavities').value,
                    material: document.getElementById('material').value,
                    items: document.getElementById('items').value,
                    totalMaterial: document.getElementById('totalMaterial').value,
                    color: document.getElementById('color').value,
                    hours: document.getElementById('hours').value,
                    startTime: document.getElementById('startTime').value,
                    estimatedEndTime: document.getElementById('estimatedEndTime').value,
                    itemsPerBag: document.getElementById('itemsPerBag').value,
                    bags: document.getElementById('bags').value,
                    timestamp: new Date().toLocaleString()
                };
                localStorage.setItem('machineData_' + machineName, JSON.stringify(data));
                alert('Δεδομένα αποθηκεύτηκαν!');
            }
        }

        function newOrder() {
            if (role === 'admin') {
                document.getElementById('client').value = '';
                document.getElementById('mold').value = '';
                document.getElementById('deliveryDate').value = '';
                document.getElementById('cyclesPerShot').value = '';
                document.getElementById('gramsPerShot').value = '';
                document.getElementById('gramsPerItem').value = '';
                document.getElementById('itemsPerShot').value = '';
                document.getElementById('blockedCavities').value = '';
                document.getElementById('material').value = '';
                document.getElementById('items').value = '';
                document.getElementById('totalMaterial').value = '';
                document.getElementById('color').value = '';
                document.getElementById('hours').value = '';
                document.getElementById('startTime').value = '';
                document.getElementById('estimatedEndTime').value = '';
                document.getElementById('itemsPerBag').value = '';
                document.getElementById('bags').value = '';
                alert('Τα πεδία καθαρίστηκαν για νέα παραγγελία!');
            }
        }

        function openMaterialPrep() {
            if (role === 'user') {
                window.location.href = `material-prep.html?name=${encodeURIComponent(machineName)}`;
            }
        }

        function goBack() {
            window.location.href = "welcome.html";
        }

        function logout() {
            sessionStorage.clear();
            window.location.href = "index.html";
        }
    </script>
</body>
</html>